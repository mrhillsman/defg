<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Desktop Entry File Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }
        /* Custom scrollbar for webkit browsers */
        ::-webkit-scrollbar {
            width: 8px;
        }
        ::-webkit-scrollbar-track {
            background: #f1f5f9;
        }
        ::-webkit-scrollbar-thumb {
            background: #94a3b8;
            border-radius: 4px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: #64748b;
        }
        /* Basic styling for toggles */
        .toggle-checkbox:checked {
            right: 0;
            border-color: #4f46e5;
        }
        .toggle-checkbox:checked + .toggle-label {
            background-color: #4f46e5;
        }
    </style>
</head>
<body class="bg-slate-50 text-slate-800">

    <div class="container mx-auto p-4 md:p-8">
        <!-- Header -->
        <header class="text-center mb-8">
            <h1 class="text-3xl md:text-4xl font-bold text-slate-900">Desktop Entry File Generator</h1>
            <p class="mt-2 text-slate-600">Create custom `.desktop` files for your Linux applications with ease.</p>
        </header>

        <!-- Main Content: Form and Preview -->
        <main class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <!-- Form Section -->
            <div class="bg-white p-6 rounded-xl shadow-md border border-slate-200">
                <form id="desktop-form">
                    <div class="space-y-6">
                        <!-- Core Settings -->
                        <div>
                            <h3 class="text-lg font-semibold border-b border-slate-200 pb-2 mb-4 text-slate-900">Core Settings</h3>
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                <div class="sm:col-span-2">
                                    <label for="name" class="block text-sm font-medium text-slate-700">Name</label>
                                    <input type="text" id="name" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" placeholder="My Awesome App" required>
                                </div>
                                <div class="sm:col-span-2">
                                    <label for="exec" class="block text-sm font-medium text-slate-700">Exec</label>
                                    <input type="text" id="exec" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" placeholder="/path/to/your/app --option">
                                </div>
                                <div>
                                    <label for="type" class="block text-sm font-medium text-slate-700">Type</label>
                                    <select id="type" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
                                        <option>Application</option>
                                        <option>Link</option>
                                        <option>Directory</option>
                                    </select>
                                </div>
                                <div>
                                    <label for="version" class="block text-sm font-medium text-slate-700">Version</label>
                                    <input type="text" id="version" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" value="1.0">
                                </div>
                                <div class="sm:col-span-2">
                                    <label for="icon" class="block text-sm font-medium text-slate-700">Icon</label>
                                    <input type="text" id="icon" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" placeholder="/path/to/icon.png or icon-name">
                                </div>
                                <div class="sm:col-span-2">
                                    <label for="categories" class="block text-sm font-medium text-slate-700">Categories</label>
                                    <input type="text" id="categories" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" placeholder="Development;IDE;Utility;">
                                </div>
                                <div class="flex items-center justify-between sm:col-span-2">
                                    <span class="text-sm font-medium text-slate-700">Run in Terminal?</span>
                                    <div class="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in">
                                        <input type="checkbox" id="terminal" class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer"/>
                                        <label for="terminal" class="toggle-label block overflow-hidden h-6 rounded-full bg-slate-300 cursor-pointer"></label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Optional Settings -->
                        <div>
                            <h3 class="text-lg font-semibold border-b border-slate-200 pb-2 mb-4 text-slate-900">Optional Settings</h3>
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                               <div class="sm:col-span-2">
                                    <label for="comment" class="block text-sm font-medium text-slate-700">Comment</label>
                                    <input type="text" id="comment" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" placeholder="A brief description of the app">
                                </div>
                                <div class="sm:col-span-2">
                                    <label for="path" class="block text-sm font-medium text-slate-700">Path (Working Directory)</label>
                                    <input type="text" id="path" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" placeholder="/path/to/working/directory">
                                </div>
                                <div class="sm:col-span-2">
                                    <label for="keywords" class="block text-sm font-medium text-slate-700">Keywords</label>
                                    <input type="text" id="keywords" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" placeholder="editor;text;code;">
                                </div>
                                <div class="sm:col-span-2">
                                    <label for="wmclass" class="block text-sm font-medium text-slate-700">StartupWMClass</label>
                                    <input type="text" id="wmclass" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" placeholder="e.g., jetbrains-toolbox">
                                </div>
                                <div class="sm:col-span-2">
                                    <label for="mimetype" class="block text-sm font-medium text-slate-700">MimeType</label>
                                    <input type="text" id="mimetype" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" placeholder="e.g., text/plain;image/jpeg;">
                                </div>
                                <div class="flex items-center justify-between">
                                    <span class="text-sm font-medium text-slate-700">Startup Notify</span>
                                    <div class="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in">
                                        <input type="checkbox" id="startupnotify" class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer"/>
                                        <label for="startupnotify" class="toggle-label block overflow-hidden h-6 rounded-full bg-slate-300 cursor-pointer"></label>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Autostart Settings -->
                        <div>
                            <h3 class="text-lg font-semibold border-b border-slate-200 pb-2 mb-4 text-slate-900">Autostart Settings</h3>
                            <div class="grid grid-cols-1 sm:grid-cols-2 gap-4">
                                <div class="flex items-center justify-between sm:col-span-2">
                                    <span class="text-sm font-medium text-slate-700">Enable Autostart (X-GNOME)</span>
                                    <div class="relative inline-block w-10 mr-2 align-middle select-none transition duration-200 ease-in">
                                        <input type="checkbox" id="gnome-autostart" class="toggle-checkbox absolute block w-6 h-6 rounded-full bg-white border-4 appearance-none cursor-pointer"/>
                                        <label for="gnome-autostart" class="toggle-label block overflow-hidden h-6 rounded-full bg-slate-300 cursor-pointer"></label>
                                    </div>
                                </div>
                                <div>
                                    <label for="autostart-delay" class="block text-sm font-medium text-slate-700">Autostart Delay</label>
                                    <input type="number" id="autostart-delay" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm" placeholder="e.g., 10">
                                </div>
                            </div>
                        </div>
                    </div>
                </form>
            </div>

            <!-- Output Section -->
            <div class="bg-slate-800 p-6 rounded-xl shadow-md border border-slate-700 flex flex-col h-[600px] lg:h-auto">
                <div class="flex-shrink-0 flex justify-between items-center mb-4">
                    <h3 class="text-lg font-semibold text-slate-100">Generated .desktop File</h3>
                    <div class="flex items-center space-x-2">
                        <button id="copy-btn" class="px-3 py-1.5 bg-indigo-600 text-white text-sm font-medium rounded-md hover:bg-indigo-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-800 focus:ring-indigo-500 transition-all">
                            Copy
                        </button>
                        <button id="download-btn" class="px-3 py-1.5 bg-slate-600 text-white text-sm font-medium rounded-md hover:bg-slate-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-800 focus:ring-slate-500 transition-all">
                            Download
                        </button>
                         <button id="reset-btn" class="px-3 py-1.5 bg-red-600 text-white text-sm font-medium rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-slate-800 focus:ring-red-500 transition-all">
                            Reset
                        </button>
                    </div>
                </div>
                <pre id="output" class="flex-grow w-full bg-slate-900 text-slate-300 p-4 rounded-md text-sm whitespace-pre-wrap break-all overflow-auto"></pre>
            </div>
        </main>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            // Get all form elements
            const form = document.getElementById('desktop-form');
            const output = document.getElementById('output');
            const copyBtn = document.getElementById('copy-btn');
            const downloadBtn = document.getElementById('download-btn');
            const resetBtn = document.getElementById('reset-btn');

            // Map input IDs to their corresponding .desktop file keys
            const keyMap = {
                'name': 'Name',
                'version': 'Version',
                'comment': 'Comment',
                'exec': 'Exec',
                'icon': 'Icon',
                'path': 'Path',
                'keywords': 'Keywords',
                'type': 'Type',
                'terminal': 'Terminal',
                'categories': 'Categories',
                'wmclass': 'StartupWMClass',
                'startupnotify': 'StartupNotify',
                'mimetype': 'MimeType',
                'gnome-autostart': 'X-GNOME-Autostart-enabled',
            };

            // This function generates the content of the .desktop file
            const generateFileContent = () => {
                let content = '[Desktop Entry]\n';
                
                // Process all text and select inputs
                Object.keys(keyMap).forEach(id => {
                    const el = document.getElementById(id);
                    if (el) {
                        let value;
                        if (el.type === 'checkbox') {
                            value = el.checked;
                        } else {
                            value = el.value.trim();
                        }
                        
                        if ((el.type !== 'checkbox' && value) || (el.type === 'checkbox' && el.checked)) {
                             content += `${keyMap[id]}=${value}\n`;
                        }
                    }
                });
                
                // Handle special cases like autostart delay
                const delayInput = document.getElementById('autostart-delay');
                const delayValue = delayInput.value.trim();
                if (delayValue) {
                    content += `X-GNOME-Autostart-Delay=${delayValue}\n`;
                    content += `X-KDE-autostart-after=panel\n`;
                    content += `X-MATE-Autostart-Delay=${delayValue}\n`;
                }

                output.textContent = content;
            };

            // Event listener for any change in the form
            form.addEventListener('input', generateFileContent);
            form.addEventListener('change', generateFileContent); // For selects and checkboxes

            // Copy button functionality
            copyBtn.addEventListener('click', () => {
                // A temporary textarea is used to hold the text for the copy command
                const textarea = document.createElement('textarea');
                textarea.value = output.textContent;
                document.body.appendChild(textarea);
                textarea.select();
                try {
                    document.execCommand('copy');
                    copyBtn.textContent = 'Copied!';
                } catch (err) {
                    copyBtn.textContent = 'Error!';
                    console.error('Failed to copy text: ', err);
                }
                document.body.removeChild(textarea);

                setTimeout(() => {
                    copyBtn.textContent = 'Copy';
                }, 2000);
            });

            // Download button functionality
            downloadBtn.addEventListener('click', () => {
                const nameInput = document.getElementById('name');
                const filename = (nameInput.value.trim().replace(/\s+/g, '-') || 'application') + '.desktop';
                const blob = new Blob([output.textContent], { type: 'application/x-desktop' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = filename;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            });
            
            // Reset button functionality
            resetBtn.addEventListener('click', () => {
                form.reset();
                // Manually trigger generation to update the view
                generateFileContent();
            });

            // Initial generation on page load
            generateFileContent();
        });
    </script>
</body>
</html>
